{"version":3,"sources":["CardField.tsx"],"names":["TextInputState","require","CardFieldNative","CardField","ref","onCardChange","onFocus","onBlur","cardStyle","placeholder","postalCodeEnabled","props","inputRef","onCardChangeHandler","event","card","nativeEvent","data","last4","expiryMonth","expiryYear","complete","brand","hasOwnProperty","postalCode","number","__DEV__","console","warn","onFocusHandler","focusedField","focusInput","current","focus","UIManager","dispatchViewManagerCommand","blur","clear","inputRefValue","registerInput","unregisterInput","currentlyFocusedInput","backgroundColor","borderColor","borderWidth","borderRadius","cursorColor","fontSize","placeholderColor","textColor","textErrorColor","fontFamily","expiration","cvc"],"mappings":"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","sourcesContent":["import type { CardFieldInput, Nullable } from '../types';\nimport React, {\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useLayoutEffect,\n  useRef,\n} from 'react';\nimport {\n  AccessibilityProps,\n  NativeSyntheticEvent,\n  requireNativeComponent,\n  UIManager,\n  StyleProp,\n  findNodeHandle,\n  ViewStyle,\n} from 'react-native';\nconst TextInputState = require('react-native/Libraries/Components/TextInput/TextInputState');\n\nconst CardFieldNative = requireNativeComponent<CardFieldInput.NativeProps>(\n  'CardField'\n);\n\n/**\n *  Card Field Component Props\n */\nexport interface Props extends AccessibilityProps {\n  style?: StyleProp<ViewStyle>;\n  postalCodeEnabled?: boolean;\n  cardStyle?: CardFieldInput.Styles;\n  placeholder?: CardFieldInput.Placeholders;\n  autofocus?: boolean;\n  onCardChange?(card: CardFieldInput.Details): void;\n  onBlur?(): void;\n  onFocus?(focusedField: Nullable<CardFieldInput.Names>): void;\n  testID?: string;\n  /**\n   * WARNING: If set to `true` the full card number will be returned in the `onCardChange` handler.\n   * Only do this if you're certain that you fulfill the necessary PCI compliance requirements.\n   * Make sure that you're not mistakenly logging or storing full card details!\n   * See the docs for details: https://stripe.com/docs/security/guide#validating-pci-compliance\n   */\n  dangerouslyGetFullCardDetails?: boolean;\n}\n\n/**\n *  Card Field Component\n *\n * @example\n * ```ts\n * <CardField\n *    postalCodeEnabled={false}\n *    onCardChange={(cardDetails) => {\n *    console.log('card details', cardDetails);\n *      setCard(cardDetails);\n *    }}\n *    style={{height: 50}}\n *  />\n * ```\n * @param __namedParameters Props\n * @returns JSX.Element\n * @category ReactComponents\n */\nexport const CardField = forwardRef<CardFieldInput.Methods, Props>(\n  (\n    {\n      onCardChange,\n      onFocus,\n      onBlur,\n      cardStyle,\n      placeholder,\n      postalCodeEnabled,\n      ...props\n    },\n    ref\n  ) => {\n    const inputRef = useRef<any>(null);\n\n    const onCardChangeHandler = useCallback(\n      (event: NativeSyntheticEvent<CardFieldInput.Details>) => {\n        const card = event.nativeEvent;\n\n        const data: CardFieldInput.Details = {\n          last4: card.last4,\n          expiryMonth: card.expiryMonth,\n          expiryYear: card.expiryYear,\n          complete: card.complete,\n          brand: card.brand,\n        };\n\n        if (card.hasOwnProperty('postalCode')) {\n          data.postalCode = card.postalCode || '';\n        }\n        if (card.hasOwnProperty('number')) {\n          data.number = card.number || '';\n          if (__DEV__ && onCardChange && card.complete) {\n            console.warn(\n              `[stripe-react-native] ⚠️ WARNING: You've enabled \\`dangerouslyGetFullCardDetails\\`, meaning full card details are being returned. Only do this if you're certain that you fulfill the necessary PCI compliance requirements. Make sure that you're not mistakenly logging or storing full card details! See the docs for details: https://stripe.com/docs/security/guide#validating-pci-compliance`\n            );\n          }\n        }\n        onCardChange?.(data);\n      },\n      [onCardChange]\n    );\n\n    const onFocusHandler = useCallback(\n      (event) => {\n        const { focusedField } = event.nativeEvent;\n        if (focusedField) {\n          TextInputState.focusInput(inputRef.current);\n          onFocus?.(focusedField);\n        } else {\n          onBlur?.();\n        }\n      },\n      [onFocus, onBlur]\n    );\n\n    const focus = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'focus' as any,\n        []\n      );\n    };\n\n    const blur = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'blur' as any,\n        []\n      );\n    };\n\n    const clear = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'clear' as any,\n        []\n      );\n    };\n\n    useImperativeHandle(ref, () => ({\n      focus,\n      blur,\n      clear,\n    }));\n\n    useLayoutEffect(() => {\n      const inputRefValue = inputRef.current;\n      if (inputRefValue !== null) {\n        TextInputState.registerInput(inputRefValue);\n        return () => {\n          TextInputState.unregisterInput(inputRefValue);\n          if (TextInputState.currentlyFocusedInput() === inputRefValue) {\n            inputRefValue.blur();\n          }\n        };\n      }\n      return () => {};\n    }, [inputRef]);\n\n    return (\n      <CardFieldNative\n        ref={inputRef}\n        onCardChange={onCardChangeHandler}\n        onFocusChange={onFocusHandler}\n        postalCodeEnabled={postalCodeEnabled ?? true}\n        cardStyle={{\n          backgroundColor: cardStyle?.backgroundColor,\n          borderColor: cardStyle?.borderColor,\n          borderWidth: cardStyle?.borderWidth,\n          borderRadius: cardStyle?.borderRadius,\n          cursorColor: cardStyle?.cursorColor,\n          fontSize: cardStyle?.fontSize,\n          placeholderColor: cardStyle?.placeholderColor,\n          textColor: cardStyle?.textColor,\n          textErrorColor: cardStyle?.textErrorColor,\n          fontFamily: cardStyle?.fontFamily,\n        }}\n        placeholder={{\n          number: placeholder?.number,\n          expiration: placeholder?.expiration,\n          cvc: placeholder?.cvc,\n          postalCode: placeholder?.postalCode,\n        }}\n        {...props}\n      />\n    );\n  }\n);\n"]}